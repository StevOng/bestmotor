{% extends 'base/base.html' %}
{% load static %}
{% load humanize %}

{% block csrf %}
  <meta name="csrf-token" content="{{ csrf_token }}">
{% endblock %}

{% block title %}Bonus Sales{% endblock %} 

{% block page_title %}Bonus Sales{% endblock %} 

{% block content %}
<!-- Overlay & Modal Tambah Bonus -->
<div id="popupModalBonus" class="fixed inset-0 hidden items-center justify-center z-50 bg-gray-500/50">
    <div class="bg-white w-full p-6 rounded-lg shadow-lg flex flex-col md:w-1/2">
        <div class="flex flex-col p-2 h-auto mb-4 rounded border-2 border-gray-200 bg-gray-50">    
            <div class="flex flex-row ml-2 mb-3 justify-between">
                <p class="font-semibold text-lg">Tambah Bonus Per Merek</p>
                <button onclick="closeModalBonus()" class="flex justify-end"><i class="fa-solid fa-x m-2 text-gray-500"></i></button>
            </div>
            <hr class="border-gray-300 pb-3">
            <div class="m-2">
                <label for="merk" class="block text-sm font-medium text-gray-700">Merk</label>
                <select id="merk"
                data-selected-merk="{{ detail_barang.merk|default:'' }}"
                    class="mt-1 block w-full border border-gray-300 rounded-md py-2 px-3 text-sm bg-white focus:outline-none focus:ring-customBlue focus:border-customBlue">
                    <option value="" disabled selected hidden>Masukkan merek barang</option>
                </select>
            </div>
            <div class="m-2">
                <label for="bonus" class="block text-sm font-medium text-gray-700">Bonus</label>
                <div class="flex items-center">
                  <input type="number" id="bonus" name="bonus" placeholder="0" value=""
                    class="mt-1 block w-full border border-gray-300 rounded-md py-2 px-3 text-right focus:outline-none focus:ring-customBlue focus:border-customBlue" {% if is_shipped %}disabled{% endif %}>
                  <span class="ml-2">%</span>
                </div>
              </div>
            <div class="mt-2 md:col-span-4 flex justify-end">
                <a href="" class="text-center">
                    <p class="text-sm font-medium text-gray-700">Tambah</p>
                    <i class="mt-1 fa-regular fa-floppy-disk text-2xl text-customBlue"></i>
                </a>
            </div>
        </div>
    </div>
</div>

<div class="flex flex-row gap-3 justify-start mb-3">
    <a href="{% url 'bonus_sales' %}" class="p-2 border-2 border-gray-200 rounded-md text-sm focus:text-white focus:bg-customBlue focus:border-customBlue {% if not list %} text-white bg-customBlue border-customBlue {% endif %}">
        Bonus Sales
    </a>
    {% if request.session.role == "admin" %}
        <a href="{% url 'bonus_merek' %}" class="p-2 border-2 border-gray-200 rounded-md text-sm focus:text-white focus:bg-customBlue focus:border-customBlue {% if list == "merek" %} text-white bg-customBlue border-customBlue {% endif %}">
            List Bonus
        </a>
    {% endif %}
    {% comment %} <div class="p-2 border-2 border-gray-200 rounded-md text-gray-500 text-sm focus:text-white focus:bg-customBlue focus:border-customBlue ">
        Jualan hari ini, bonus menanti nanti! Fokus, semangat, dan konsisten, cuan pasti datang!
    </div> {% endcomment %}
</div>
<div
  class="flex flex-col p-2 h-auto mb-4 rounded border-2 border-gray-200 bg-gray-50"
>    
    <p class="ml-3 mt-2 font-bold text-base text-customBlue">
        {% if list == 'merek' %}
            List Bonus Per Merek
        {% elif request.session.role == "admin" %}
            Total Penjualan Per Sales
        {% else  %}
            Total Penjualan Per Customer
        {% endif %}
    </p>
    <div class="mt-5 flex flex-row justify-between">
        <div class="justify-start ml-3">
            <input type="text" id="tableSearch" class="form-control rounded-lg border-gray-200 border-2 max-w-40 focus:border-customBlue lg:max-w-full" placeholder="Cari disini...">
            <button class="bg-customBlue border-customBlue hover:bg-[#243F6B] p-2 rounded-lg text-white w-12" type="button">
                <i class="fas fa-search"></i>
            </button>
        </div>
        {% if request.session.role == "admin" and list == 'merek' %}
            <div class="inline-flex gap-2">
                <button onclick="openModalBonus()" class="p-2 justify-end border-2 rounded-lg border-gray-200">
                    <div class="flex flex-row justify-center items-center">
                        <p class="hidden lg:block p-1 lg:text-gray-400">Tambah Bonus Merek</p>
                        <i class="fas fa-plus p-1 text-customBlue"></i>
                    </div>
                </button>
            </div>
        {% endif %}
    </div>
    <table id="tabel-bonus" class="display cell-border">
        <thead>
            {% if not list %}
                <tr>
                    <th>No</th>
                    {% if request.session.role == "admin" %}
                        <th>Nama Sales</th>
                    {% else %}
                        <th>Nama Customer</th>
                    {% endif %}
                    <th>Total Pesanan</th>
                    <th>Total Penjualan</th>
                    <th>Total Bonus</th>
                    {% if request.session.role == "admin" %}
                        <th>Bayar</th>
                    {% endif %}
                </tr>
            {% else %}
                <tr>
                    <th>No</th>
                    <th>Merek</th>
                    <th>Bonus %</th>
                    <th>Edit</th>
                </tr>
            {% endif %}
        </thead>
        <tbody>
            {% if not list %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    {% if request.session.role == "admin" %}
                        <td>Sales 1</td>
                    {% else %}
                        <td>Customer 1</td>
                    {% endif %}
                    <td></td>
                    <td></td>
                    <td></td>
                    {% if request.session.role == "admin" %}
                        <td>
                            <button>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M9 11L12 14L22 4M16 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21H16.2C17.8802 21 18.7202 21 19.362 20.673C19.9265 20.3854 20.3854 19.9265 20.673 19.362C21 18.7202 21 17.8802 21 16.2V12" stroke="#3D5A80" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </td>
                    {% endif %}
                </tr>
            {% else %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>Honda</td>
                    <td>10 %</td>
                    <td><button onclick="openModalBonus()"><i class="fa-regular fa-eye text-2xl text-customBlue"></i></button></td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block script %}
<script src="{% static "js/bonus.js" %}">
{% endblock %}